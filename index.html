<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XEyes Mugshot</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #1a1a2e;
      font-family: system-ui, sans-serif;
      color: #eee;
    }
    h1 {
      margin-bottom: 1rem;
      font-weight: 300;
      letter-spacing: 0.05em;
    }
    .mugshot {
      display: inline-block;
      max-width: 90vw;
      max-height: 80vh;
    }
    .mugshot img {
      display: block;
      width: 100%;
      height: auto;
    }
    .tuning-info {
      margin-top: 1.5rem;
      font-size: 0.8rem;
      color: #888;
      text-align: center;
      max-width: 600px;
      line-height: 1.6;
    }
    .tuning-info code {
      background: #333;
      padding: 0.1em 0.4em;
      border-radius: 3px;
      color: #adf;
    }
    .rec-hint {
      margin-top: 0.8rem;
      font-size: 0.75rem;
      color: #999;
      text-align: center;
    }
    .rec-hint kbd {
      display: inline-block;
      background: #333;
      border: 1px solid #555;
      border-radius: 3px;
      padding: 0.1em 0.5em;
      font-family: inherit;
      font-size: 0.9em;
      color: #ccc;
      box-shadow: 0 1px 0 #222;
    }
    .shelf-mount {
      display: flex;
      justify-content: center;
    }
  </style>
</head>
<body>
  <h1>XEyes Mugshot</h1>
  <!--
    Tuning guide (all values in the image's native pixel space, 640x480):
      data-xeyes-radius   = eye white circle radius
      data-xeyes-pupil-radius = pupil radius (default: radius/2)
      data-xeyes-ipd       = interpupillary distance
      data-xeyes-voffset   = vertical offset from image center (negative = up)
      data-xeyes-hoffset   = horizontal offset from image center (positive = right)
      data-xeyes-fill      = eye fill color (try "transparent" to hide whites)
      data-xeyes-stroke    = eye outline color (try "none" to hide)
      data-xeyes-stroke-width = outline thickness
      data-xeyes-pupil-fill = pupil color
    The photo is 640x480, center is (320, 240).
    Eyes measured at approximately:
      Left eye:  (285, 193)
      Right eye: (370, 193)
      Midpoint:  (327.5, 193)
      IPD:       85px
      Offsets:   h=+7.5, v=-47
  -->
  <div class="mugshot"
       data-xeyes
       data-xeyes-radius="7.2"
       data-xeyes-lateral-radius="12.5"
       data-xeyes-pupil-radius="4"
       data-xeyes-iris-radius="7"
       data-xeyes-iris-color="rgb(37 87 140)"
       data-xeyes-ipd="82"
       data-xeyes-voffset="3"
       data-xeyes-hoffset="8"
       data-xeyes-stroke-width=".5"
       data-xeyes-stroke="rgb(90 90 90)"
       data-xeyes-fill="rgb(250 247 247)"
       data-xeyes-pupil-fill="black">
    <img src="mugshot.jpeg" alt="Mugshot">
  </div>

  <div class="tuning-info">
    Move your mouse (or finger) around to see the eyes follow.
    Tweak alignment by editing the <code>data-xeyes-*</code> attributes in the HTML.
    Try <code>data-xeyes-fill="transparent"</code> and <code>data-xeyes-stroke="none"</code>
    to show just the pupils floating over your real eyes.
  </div>

  <div class="rec-hint">
    Hold <kbd>Space</kbd> to record a clip. Scroll wheel adjusts gaze depth.
  </div>

  <div class="shelf-mount"></div>

  <script src="xeyes_overlay.js"></script>
  <script src="div_recorder.js"></script>
  <script src="recording_shelf.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var mugshot = document.querySelector('.mugshot');

      var recorder = new DivRecorder({ target: mugshot, fps: 30 });
      var shelf = new RecordingShelf({
        container: document.querySelector('.shelf-mount'),
        target: mugshot,
      });

      if (!recorder.mp4Supported) {
        var hint = document.querySelector('.rec-hint');
        hint.textContent += ' (.mp4 not supported in this browser, .webm only)';
      }

      document.addEventListener('keydown', function(e) {
        if (e.code === 'Space' && !e.repeat && !recorder.isRecording) {
          e.preventDefault();
          recorder.start();
        }
      });

      document.addEventListener('keyup', function(e) {
        if (e.code === 'Space' && recorder.isRecording) {
          e.preventDefault();
          recorder.stop().then(function(result) {
            if (result) shelf.addRecording(result.blobs, result.name);
          });
        }
      });
    });
  </script>
</body>
</html>